var typeScriptHelper=function(n){"use strict";function o(n){var t;return n=n||{},typeof n.codeGenTarget=="string"&&(n.codeGenTarget=s(n.codeGenTarget)),t=u(u({},e),n)}function s(n){var i;switch(n){case"EcmaScript3":i=0;break;case"EcmaScript5":i=1;break;default:throw{name:"TypeError",message:t("ECMAScript target version '{0}' not supported.",n)};}return i}function u(n,t){var i;n=n||{};for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function t(){for(var u=arguments[0],t=u,i,r,f=arguments.length,n=0;n<f-1;n++)i=new RegExp("\\{"+n+"\\}","gm"),r=arguments[n+1],t=t.replace(i,function(){return r});return t}function i(n){return n.toLocaleUpperCase()}var r={},e={propagateConstants:!1,minWhitespace:!1,emitComments:!0,watch:!1,exec:!1,resolve:!0,disallowBool:!1,allowAutomaticSemicolonInsertion:!0,allowModuleKeywordInExternalModuleReference:!0,useDefaultLib:!0,codeGenTarget:0,moduleGenTarget:0,outputOption:"",mapSourceFiles:!1,emitFullSourceMapPath:!1,generateDeclarationFiles:!1,useCaseSensitiveFileResolution:!1,gatherDiagnostics:!1,updateTC:!1,implicitAny:!1},f=function(){function n(){}return n.prototype.Write=function(){},n.prototype.WriteLine=function(){},n.prototype.Close=function(){},n}(),h=function(){function n(n){this._files=n,this.arguments=[],this.stderr=new f,this.stdout=new f}var r="Method 'IoHost.{0}' is not supported.";return n.prototype.readFile=function(n){var r=i(n),u;if(typeof this._files[r]=="undefined")throw new Error(t("File '{0}' does not exist.",n));return u=this._files[r],new FileInformation(u.content,0)},n.prototype.writeFile=function(n,t){var r=i(n);this._files[r]={path:n,content:t}},n.prototype.deleteFile=function(n){var t=i(n);this._files[t]=undefined},n.prototype.dir=function(){throw new Error(t(r,"dir"));},n.prototype.fileExists=function(n){var t=i(n);return typeof this._files[t]!="undefined"},n.prototype.directoryExists=function(){throw new Error(t(r,"directoryExists"));},n.prototype.createDirectory=function(){throw new Error(t(r,"createDirectory"));},n.prototype.resolvePath=function(n){return n},n.prototype.dirName=function(){return""},n.prototype.findFile=function(){throw new Error(t(r,"findFile"));},n.prototype.print=function(){throw new Error(t(r,"print"));},n.prototype.printLine=function(){throw new Error(t(r,"printLine"));},n.prototype.watchFile=function(){throw new Error(t(r,"watchFile"));},n.prototype.run=function(){throw new Error(t(r,"run"));},n.prototype.getExecutingFilePath=function(){throw new Error(t(r,"getExecutingFilePath"));},n.prototype.quit=function(){throw new Error(t(r,"quit"));},n.prototype.dispose=function(){this._files=null,this.arguments=null,this.stderr=null,this.stdout=null},n}(),c=function(){function t(n,t){this.ioHost=n,this.setCompilationEnvironment(t),this.errors=[],this.hasErrors=!1}return t.prototype.addDiagnostic=function(t){var u=0,f=0,i,e,r;this.hasErrors=!0,t.fileName()&&(i=this.compilationEnvironment.getSourceUnit(t.fileName()),i||(i=new n.SourceUnit(t.fileName(),this.ioHost.readFile(t.fileName()))),e=new n.LineMap(i.getLineStartPositions(),i.getLength()),r={line:-1,character:-1},e.fillLineAndCharacterFromPosition(t.start(),r),u=r.line+1,f=r.character+1),this.errors.push({message:t.message(),fileName:t.fileName(),lineNumber:u,columnNumber:f})},t.prototype.setCompilationEnvironment=function(n){this.compilationEnvironment=n},t.prototype.reset=function(){this.errors=[],this.hasErrors=!1},t.prototype.dispose=function(){this.ioHost=null,this.setCompilationEnvironment(null),this.errors=null,this.hasErrors=!1},t}(),l=function(){function t(n,t){this.compilationSettings=n,this.errorReporter=t,this.pathMap={},this.resolvedPaths={}}return t.prototype.getPathIdentifier=function(n){return this.compilationSettings.useCaseSensitiveFileResolution?n:n.toLocaleUpperCase()},t.prototype.isResolved=function(n){return this.resolvedPaths[this.getPathIdentifier(this.pathMap[n])]!=undefined},t.prototype.resolveCompilationEnvironment=function(t,i){var u=this,f=new n.CompilationEnvironment(t.compilationSettings,t.ioHost),s=t.code.length,e,o,r;for(this.errorReporter.setCompilationEnvironment(f),o={errorReporter:this.errorReporter,postResolution:function(n,t){var i=u.getPathIdentifier(n);u.resolvedPaths[i]||(f.code.push(t),u.resolvedPaths[i]=!0)}},r=0;r<s;r++)e=n.switchToForwardSlashes(t.ioHost.resolvePath(t.code[r].path)),this.pathMap[t.code[r].path]=e,i.resolveCode(e,"",!1,o);return f},t.prototype.dispose=function(){this.compilationSettings=null,this.errorReporter=null,this.pathMap=null,this.resolvedPaths=null},t}(),a=function(){function n(n){this._ioHost=n}return n.prototype.writeFile=function(n,t,i){this._ioHost.writeFile(n,t,i)},n.prototype.directoryExists=function(n){return this._ioHost.directoryExists(n)},n.prototype.fileExists=function(n){return this._ioHost.fileExists(n)},n.prototype.resolvePath=function(n){return n},n.prototype.dispose=function(){this._ioHost=null},n}(),v=function(){function t(t,i){this.ioHost=t,this.resolvedEnvironment=null,this.hasResolveErrors=!1,this.compilerVersion="0.9.0.1",this.printedVersion=!1,this.compilationSettings=i,this.compilationEnvironment=new n.CompilationEnvironment(this.compilationSettings,this.ioHost),this.errorReporter=new c(this.ioHost,this.compilationEnvironment)}return t.prototype.batchCompile=function(t){var i=this.compilationEnvironment.code;this.compilationSettings.useDefaultLib&&i.push(new n.SourceUnit("lib.d.ts",null)),i.push(new n.SourceUnit(t,null)),this.resolvedEnvironment=this.compilationSettings.resolve?this.resolve():this.compilationEnvironment,this.compile()},t.prototype.resolve=function(){for(var u=new n.CodeResolver(this.compilationEnvironment),r=new l(this.compilationSettings,this.errorReporter),f=r.resolveCompilationEnvironment(this.compilationEnvironment,u,!0),i,t=0;t<this.compilationEnvironment.code.length;t++)r.isResolved(this.compilationEnvironment.code[t].path)||(i=this.compilationEnvironment.code[t].path,n.isTSFile(i)||n.isDTSFile(i)?this.errorReporter.addDiagnostic(new n.Diagnostic(null,0,0,268,[i])):this.errorReporter.addDiagnostic(new n.Diagnostic(null,0,0,269,[i])));return r.dispose(),f},t.prototype.compile=function(){var b=this,h,i,c=!1,l=!1,r,t,f,e,u,v,y,o,s;for(h=new n.NullLogger,i=new n.TypeScriptCompiler(h,this.compilationSettings,null),r=0;r<this.resolvedEnvironment.code.length;r++){if(t=this.resolvedEnvironment.code[r],!this.compilationSettings.resolve){try{t.fileInformation=this.ioHost.readFile(t.path)}catch(d){d.isUnsupportedEncoding&&this.errorReporter.addDiagnostic(new n.Diagnostic(null,0,0,276,[t.path]))}this.compilationSettings.generateDeclarationFiles&&(n.CompilerDiagnostics.assert(t.referencedFiles===null,"With no resolve option, referenced files need to null"),t.referencedFiles=n.getReferencedFiles(t.path,t))}t.fileInformation!=null&&(i.addSourceUnit(t.path,n.ScriptSnapshot.fromString(t.fileInformation.contents()),t.fileInformation.byteOrderMark(),0,!1,t.referencedFiles),f=i.getSyntacticDiagnostics(t.path),i.reportDiagnostics(f,this.errorReporter),f.length>0&&(c=!0))}if(c)return!0;for(i.pullTypeCheck(),e=i.fileNameToDocument.getAllKeys(),u=0,v=e.length;u<v;u++)y=e[u],o=i.getSemanticDiagnostics(y),o.length>0&&(l=!0,i.reportDiagnostics(o,this.errorReporter));var p=new a(this.ioHost),k=function(n,t){b.resolvedEnvironment.inputFileNameToOutputFileName.addOrUpdate(n,t)},w=i.emitAll(p,k);return(i.reportDiagnostics(w,this.errorReporter),p.dispose(),w.length>0)?!0:l?!0:(s=i.emitAllDeclarations(),i.reportDiagnostics(s,this.errorReporter),s.length>0)?!0:!1},t.prototype.dispose=function(){this.ioHost=null,this.resolvedEnvironment=null,this.compilationSettings=null,this.compilationEnvironment=null,this.errorReporter.dispose(),this.errorReporter=null},t}();return r.compile=function(n,t,r,u){var l={compiledCode:""},e=t,w,d=e.replace(/\.ts$/i,".js"),a,s,y,c,b,k,p,f;if(s={},r)for(b=r.length,c=0;c<b;c++)y=r[c],k=i(y.path),s[k]=y;return w=i(e),s[w]={content:n,path:e},p=new h(s),f=new v(p,o(u)),f.batchCompile(e),f.errorReporter.hasErrors?l.errors=f.errorReporter.errors:(a=f.ioHost.readFile(d),a&&(l.compiledCode=a.contents())),f.dispose(),p.dispose(),JSON.stringify(l)},r}(TypeScript);